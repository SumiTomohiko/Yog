
YOG = yog
YOG_DIR = src
YOG_LIB = $(YOG_DIR)/libyog.la

ONIG_DIR = onig
ONIG_LIB = $(ONIG_DIR)/libonig.la

BDW_DIR = bdwgc
BDW_LIB = $(BDW_DIR)/libgc.la

all: $(YOG)
	(cd $(ONIG_DIR); make)
	(cd $(BDW_DIR); make)
	(cd $(YOG_DIR); make)
	./libtool --tag=CC --mode=link $(CC) -o $< $(YOG_LIB) $(ONIG_LIB) $(BDW_LIB)

proto: 
	python tools/update_prototype.py

TEST_CMD = py.test

test: 
	make test-copying
	make test-mark-sweep
	make test-mark-sweep-compact
	make test-bdw
test-copying: 
	GC=copying $(TEST_CMD)
test-mark-sweep: 
	GC=mark-sweep $(TEST_CMD)
test-mark-sweep-compact: 
	GC=mark-sweep-compact $(TEST_CMD)
test-bdw:
	GC=bdw $(TEST_CMD)

am--refresh:
	@:
