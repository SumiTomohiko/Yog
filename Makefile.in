
ONIG_DIR = onig
BDW_DIR = bdwgc
SIGSEGV_DIR = sigsegv
YOG_DIR = src
SUBDIRS = $(ONIG_DIR) $(BDW_DIR) $(SIGSEGV_DIR) $(YOG_DIR)

CONFIG_DISTCLEAN_FILES = config.status config.cache config.log \
			 configure.lineno config.status.lineno

all: 
	for subdir in $(SUBDIRS); do \
		(cd $${subdir}; $(MAKE)); \
	done

clean: 
	for subdir in $(SUBDIRS); do \
		(cd $${subdir}; $(MAKE) clean); \
	done

distclean: 
	for subdir in $(SUBDIRS); do \
		(cd $${subdir}; $(MAKE) distclean); \
	done
	rm -f $(CONFIG_DISTCLEAN_FILES)
	rm -f Makefile

maintainer-clean: 
	for subdir in $(SUBDIRS); do \
		(cd $${subdir}; $(MAKE) maintainer-clean); \
	done
	rm -f $(CONFIG_DISTCLEAN_FILES)
	rm -rf autom4te.cache
	rm -f Makefile

proto: 
	python tools/update_prototype.py

TEST_CMD = py.test

test: 
	make test-copying
	make test-mark-sweep
	make test-mark-sweep-compact
	make test-bdw
	make test-generational
test-copying: 
	GC=copying $(TEST_CMD)
test-mark-sweep: 
	GC=mark-sweep $(TEST_CMD)
test-mark-sweep-compact: 
	GC=mark-sweep-compact $(TEST_CMD)
test-bdw:
	GC=bdw $(TEST_CMD)
test-generational:
	GC=generational $(TEST_CMD)

am--refresh:
	@:
