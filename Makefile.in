
DIRS = @DIRS@

CONFIG_DISTCLEAN_FILES = config.status config.cache config.log \
			 configure.lineno config.status.lineno

all: 
	@for subdir in $(DIRS); do \
		(cd $${subdir}; $(MAKE)); \
	done

clean: 
	@for subdir in $(DIRS); do \
		(cd $${subdir}; $(MAKE) clean); \
	done
	find tests -name "*.pyc" -print0 | xargs --null rm -f

distclean: 
	@for subdir in $(DIRS); do \
		(cd $${subdir}; $(MAKE) distclean); \
	done
	find tests -name "*.pyc" -print0 | xargs --null rm -f
	rm -f $(CONFIG_DISTCLEAN_FILES)
	rm -f Makefile

maintainer-clean: 
	@for subdir in $(DIRS); do \
		(cd $${subdir}; $(MAKE) maintainer-clean); \
	done
	find tests -name "*.pyc" -print0 | xargs --null rm -f
	rm -f $(CONFIG_DISTCLEAN_FILES)
	rm -rf autom4te.cache
	rm -f Makefile

proto: 
	python tools/update_prototype.py

TEST_CMD = py.test
TEST_TARGETS = @TEST_TARGETS@

test: 
	@for target in $(TEST_TARGETS); do \
		$(MAKE) $${target}; \
	done
test-copying: 
	GC=copying $(TEST_CMD)
test-mark-sweep: 
	GC=mark-sweep $(TEST_CMD)
test-mark-sweep-compact: 
	GC=mark-sweep-compact $(TEST_CMD)
test-bdw:
	GC=bdw $(TEST_CMD)
test-generational:
	GC=generational $(TEST_CMD)

am--refresh:
	@:
