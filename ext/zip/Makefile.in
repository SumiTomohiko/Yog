
top_srcdir = @top_srcdir@
OBJEXT = @OBJEXT@
SOEXT = @SOEXT@
SO = $(top_srcdir)/ext/zip.$(SOEXT)
CC = @CC@
LDFLAGS = @LDFLAGS@
CFLAGS = @CFLAGS@
LIBZIP_DIR = libzip
LIBZIP_BIN = $(LIBZIP_DIR)/lib/.libs/libzip.a

all: $(SO)

$(SO): zip.$(OBJEXT) $(LIBZIP_BIN)
	$(CC) -o $@ -shared $(LDFLAGS) zip.$(OBJEXT) $(LIBZIP_BIN)

zip.$(OBJEXT): zip.c
	$(CC) -o $@ -c $(CFLAGS) zip.c

$(LIBZIP_BIN):
	cd $(LIBZIP_DIR) && make

Makefile: Makefile.in
	cd $(top_srcdir) && ./config.status ext/zip/$@

clean:
	rm -f $(SO) zip.$(OBJEXT)

# vim: tabstop=8 shiftwidth=8 noexpandtab
