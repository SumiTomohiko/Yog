
top_srcdir = @top_srcdir@
CXXFLAGS = @CXXFLAGS@ @CFLAGS@
CXX = @CXX@
SOEXT = @SOEXT@
EXT_DIR = $(top_srcdir)/ext
SO = $(EXT_DIR)/_wx$(SOEXT)
YG = $(EXT_DIR)/wx.yg
SWIG_DIR = $(top_srcdir)/tools/swig
SWIG = $(SWIG_DIR)/swig
WX_DIR = wxWidgets
WX_CONFIG = $(WX_DIR)/wx-config
WX_TYPE = @WX_TYPE@
WX_BIN = $(WX_DIR)/lib/libwx_$(WX_TYPE)d-2.8.a
IMPORT_LIB = @IMPORT_LIB@

all: $(SO) $(YG)

clean:
	rm -f $(SO) $(YG) wx_wrap.*

$(YG): wx.yg
	cp wx.yg $@

$(SO): wx_wrap.o $(WX_BIN)
	$(CXX) -o $@ -shared wx_wrap.o `$(WX_CONFIG) --libs` $(IMPORT_LIB)

wx_wrap.o: wx_wrap.cxx
	$(CXX) $(CXXFLAGS) `$(WX_CONFIG) --unicode=no --static --cppflags` -I$(top_srcdir)/include -Wall -g -c -DSWIGRUNTIME_DEBUG -o $@ wx_wrap.cxx

$(WX_BIN): $(WX_DIR)/include/wx/config.h
	cd wxWidgets && make

wx.yg wx_wrap.cxx: wx.i $(SWIG)
	$(SWIG) -c++ -yog -I$(SWIG_DIR)/Lib wx.i

$(SWIG):
	cd $(SWIG_DIR) && make

Makefile: Makefile.in
	cd $(top_srcdir) && ./config.status ext/wx/$@

# vim: tabstop=8 shiftwidth=8 noexpandtab
