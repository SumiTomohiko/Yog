/**
 * inst <name>
 * (operand_type operand_name, ...)
 * (pop_value, ...)
 * <- top bottom ->
 * (push_value, ...)
 * <- top bottom ->
 * {
 *      C code.
 * }
 */

inst push_const
(uint8_t index)
()
(val)
{
    val = CONSTS(index);
}

inst call_method
(ID method, uint8_t argc)
(...)
(...)
{
    YogVal args[argc];
    unsigned int i = 0;
    for (i = 0; i < argc; i++) {
        args[i] = POP();
    }
    YogVal receiver = POP();
    YogVal ret = YogThread_call_method(ENV, receiver, method, argc, args);
    PUSH(ret);
}

inst store_pkg
(ID id) 
(val) 
()
{
    YogVal key = YogVal_symbol(id);
    YogTable_insert(ENV, PKG_VARS(FRAME), key, val);
}

/**
 * vim: tabstop=4 shiftwidth=4 expandtab softtabstop=4 filetype=c
 */
