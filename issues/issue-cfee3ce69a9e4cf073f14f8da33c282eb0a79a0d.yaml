--- !ditz.rubyforge.org,2008-03-06/issue 
title: Calling with keyword arguments causes segmentation fault.
desc: |-
  >>> def foo(*kw)
  ...   kw.each() do [key, value]
  ...     print(key)
  ...     print(":")
  ...     print(value)
  ...     print("\n")
  ...   end
  ... end
  >>> foo(bar: 42, baz: 26)
type: :bugfix
component: core
release: 
reporter: Sumi Tomohiko <SumiTomohiko@neko-daisuki.ddo.jp>
status: :closed
disposition: :fixed
creation_time: 2009-08-30 12:37:29.738518 Z
references: []

id: cfee3ce69a9e4cf073f14f8da33c282eb0a79a0d
log_events: 
- - 2009-08-30 12:37:30.846644 Z
  - Sumi Tomohiko <SumiTomohiko@neko-daisuki.ddo.jp>
  - created
  - ""
- - 2009-08-31 16:24:02.623336 Z
  - Sumi Tomohiko <SumiTomohiko@neko-daisuki.ddo.jp>
  - commented
  - |-
    $ gdb src/yog core
    GNU gdb 6.8-debian
    Copyright (C) 2008 Free Software Foundation, Inc.
    License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
    This is free software: you are free to change and redistribute it.
    There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
    and "show warranty" for details.
    This GDB was configured as "i486-linux-gnu"...
    
    warning: Can't read pathname for load map: Input/output error.
    Reading symbols from /lib/tls/i686/cmov/libdl.so.2...Reading symbols from /usr/lib/debug/lib/tls/i686/cmov/libdl-2.7.so...done.
    done.
    Loaded symbols for /lib/tls/i686/cmov/libdl.so.2
    Reading symbols from /lib/tls/i686/cmov/libm.so.6...Reading symbols from /usr/lib/debug/lib/tls/i686/cmov/libm-2.7.so...done.
    done.
    Loaded symbols for /lib/tls/i686/cmov/libm.so.6
    Reading symbols from /lib/tls/i686/cmov/libpthread.so.0...Reading symbols from /usr/lib/debug/lib/tls/i686/cmov/libpthread-2.7.so...done.
    done.
    Loaded symbols for /lib/tls/i686/cmov/libpthread.so.0
    Reading symbols from /lib/tls/i686/cmov/libc.so.6...Reading symbols from /usr/lib/debug/lib/tls/i686/cmov/libc-2.7.so...done.
    done.
    Loaded symbols for /lib/tls/i686/cmov/libc.so.6
    Reading symbols from /lib/ld-linux.so.2...Reading symbols from /usr/lib/debug/lib/ld-2.7.so...done.
    done.
    Loaded symbols for /lib/ld-linux.so.2
    Core was generated by `src/yog --gc-stress foo.yg'.
    Program terminated with signal 11, Segmentation fault.
    [New process 3915]
    
    113         tbl = PTR_AS(YogDict, self)->tbl;
    (gdb) bt
    
        callee=3083591972, self=2, posargc=0 '\0', posargs=0xbfea2c90, blockarg=2,
        kwargc=2 '\002', kwargs=0xbfea2ca0, vararg=2, varkwarg=2) at function.c:123
    
        code=3083592156) at eval.c:656
    
        filename=0xbfea4596 "foo.yg", pkg_name=0x80a5c43 "__main__") at eval.c:681
- - 2009-08-31 16:24:52.685655 Z
  - Sumi Tomohiko <SumiTomohiko@neko-daisuki.ddo.jp>
  - commented
  - |-
    tom@nymphenburg$ gdb src/yog core                              [~/projects/Yog]
    GNU gdb 6.8-debian
    Copyright (C) 2008 Free Software Foundation, Inc.
    License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
    This is free software: you are free to change and redistribute it.
    There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
    and "show warranty" for details.
    This GDB was configured as "i486-linux-gnu"...
    
    warning: Can't read pathname for load map: Input/output error.
    Reading symbols from /lib/tls/i686/cmov/libdl.so.2...Reading symbols from /usr/lib/debug/lib/tls/i686/cmov/libdl-2.7.so...done.
    done.
    Loaded symbols for /lib/tls/i686/cmov/libdl.so.2
    Reading symbols from /lib/tls/i686/cmov/libm.so.6...Reading symbols from /usr/lib/debug/lib/tls/i686/cmov/libm-2.7.so...done.
    done.
    Loaded symbols for /lib/tls/i686/cmov/libm.so.6
    Reading symbols from /lib/tls/i686/cmov/libpthread.so.0...Reading symbols from /usr/lib/debug/lib/tls/i686/cmov/libpthread-2.7.so...done.
    done.
    Loaded symbols for /lib/tls/i686/cmov/libpthread.so.0
    Reading symbols from /lib/tls/i686/cmov/libc.so.6...Reading symbols from /usr/lib/debug/lib/tls/i686/cmov/libc-2.7.so...done.
    done.
    Loaded symbols for /lib/tls/i686/cmov/libc.so.6
    Reading symbols from /lib/ld-linux.so.2...Reading symbols from /usr/lib/debug/lib/ld-2.7.so...done.
    done.
    Loaded symbols for /lib/ld-linux.so.2
    Core was generated by `src/yog --gc-stress foo.yg'.
    Program terminated with signal 11, Segmentation fault.
    [New process 3915]
    #0  YogDict_set (env=0xbfea308c, self=2, key=2190, value=85) at dict.c:113
    113         tbl = PTR_AS(YogDict, self)->tbl;
    (gdb) bt
    #0  YogDict_set (env=0xbfea308c, self=2, key=2190, value=85) at dict.c:113
    #1  0x0806a450 in YogFunction_exec_for_instance (env=0xbfea308c,
        callee=3083591972, self=2, posargc=0 '\0', posargs=0xbfea2c90, blockarg=2,
        kwargc=2 '\002', kwargs=0xbfea2ca0, vararg=2, varkwarg=2) at function.c:123
    #2  0x0806340d in YogEval_mainloop (env=0xbfea308c) at ../src/eval.inc:133
    #3  0x080642d8 in YogEval_eval_package (env=0xbfea308c, pkg=3083592120,
        code=3083592156) at eval.c:656
    #4  0x08064407 in YogEval_eval_file (env=0xbfea308c, fp=0x80cb030,
        filename=0xbfea4596 "foo.yg", pkg_name=0x80a5c43 "__main__") at eval.c:681
    #5  0x0806d72e in main (argc=3, argv=0xbfea3334) at main.c:109
- - 2009-09-01 12:56:03.779299 Z
  - Sumi Tomohiko <SumiTomohiko@neko-daisuki.ddo.jp>
  - changed status from unstarted to in_progress
  - ""
- - 2009-09-02 06:42:38.005384 Z
  - Sumi Tomohiko <SumiTomohiko@neko-daisuki.ddo.jp>
  - closed with disposition fixed
  - ""
